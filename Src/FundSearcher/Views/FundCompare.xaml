<UserControl x:Class="FundSearcher.Views.FundCompare"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:coreConsts="clr-namespace:Fund.Core.Consts;assembly=Fund.Core"
             prism:ViewModelLocator.AutoWireViewModel="True"
             mc:Ignorable="d" 
             d:DesignHeight="1000" d:DesignWidth="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Label Grid.Row="0" Grid.Column="0" Content="基金：" Style="{StaticResource QueryLabel}"/>
        <ListView Grid.Row="0" Grid.Column="1" Style="{StaticResource HorizontalFilterListView}" SelectionMode="Multiple"
                  ItemsSource="{Binding ShowFundInfos}" PreviewMouseLeftButtonDown="ListView_PreviewMouseLeftButtonDown"/>

        <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
            <Button Content="返回" Style="{StaticResource QueryButton}" Command="{Binding GoBackCommand}"/>
        </StackPanel>

        <DataGrid x:Name="dgCompare" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Loaded="DataGrid_Loaded"
                  EnableColumnVirtualization="False" EnableRowVirtualization="False"
                  RowStyle="{StaticResource ShowDataGridRow}"
                  Style="{StaticResource CompareDataGrid}" ItemsSource="{Binding FundInfos}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="{x:Static coreConsts:FundColumnName.FundId}" IsReadOnly="True" Binding="{Binding FundId}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:FundColumnName.FundName}" IsReadOnly="True" Binding="{Binding FundName}"/>

                <DataGridTextColumn IsReadOnly="True">
                    <DataGridTextColumn.Header>
                        <TextBlock Text="{x:Static coreConsts:CommonName.FundInfo}" FontWeight="Bold"/>
                    </DataGridTextColumn.Header>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:FundColumnName.BirthDay}" IsReadOnly="True" Binding="{Binding BirthDay,Converter={StaticResource BirthDayConverter}}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:FundColumnName.AssetWithUnit}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource FundSizeConverter}">
                            <Binding Source="{StaticResource StringFormatF2}"/>
                            <Binding Path="AssetSize"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:FundColumnName.ShareWithUnit}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource FundSizeConverter}">
                            <Binding Source="{StaticResource StringFormatF4}"/>
                            <Binding Path="ShareSize"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:FundColumnName.FundClass}" IsReadOnly="True" Binding="{Binding FundClass}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:FundColumnName.TrackingTarget}" IsReadOnly="True" Binding="{Binding TrackingTarget}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:CommonName.InfoSource}" IsReadOnly="True" Binding="{Binding InfoSource}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:CommonName.UpdateTime}" IsReadOnly="True" Binding="{Binding UpdateTime,StringFormat=yyyy-MM-dd HH:mm:ss}"/>

                <DataGridTextColumn IsReadOnly="True">
                    <DataGridTextColumn.Header>
                        <TextBlock Text="{x:Static coreConsts:CommonName.TransactionInfo}" FontWeight="Bold"/>
                    </DataGridTextColumn.Header>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:FundColumnName.Counter}" IsReadOnly="True" Binding="{Binding Counter}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.Price}" IsReadOnly="True" Binding="{Binding TransactionInfo.Price,StringFormat=F4}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.BuyUpperLimitAmountWithUnit}" IsReadOnly="True" Binding="{Binding TransactionInfo.BuyUpperLimitAmount,Converter={StaticResource BuyUpperLimitAmountConverter}}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.NormalBuyRates}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource CompareRateDisplayConverter}">
                            <Binding Path="Counter"/>
                            <Binding Path="TransactionInfo.ApplyRates"/>
                            <Binding Path="TransactionInfo.BuyRates"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.ManageRateWithUnit}" IsReadOnly="True" Binding="{Binding TransactionInfo.ManageRate,StringFormat=0.00%}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.HostingRateWithUnit}" IsReadOnly="True" Binding="{Binding TransactionInfo.HostingRate,StringFormat=0.00%}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.SalesServiceRateWithUnit}" IsReadOnly="True" Binding="{Binding TransactionInfo.SalesServiceRate,StringFormat=0.00%}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.RunningRateWithUnit}" IsReadOnly="True" Binding="{Binding TransactionInfo.RunningRate,StringFormat=0.00%}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.BuyConfirmDate}" IsReadOnly="True" Binding="{Binding TransactionInfo.BuyConfirmDate}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.SellRates}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource CompareRateDisplayConverter}">
                            <Binding Source="{x:Static coreConsts:TransactionColumnName.SellRates}"/>
                            <Binding Path="TransactionInfo.SellRates"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:TransactionColumnName.SellConfirmDate}" IsReadOnly="True" Binding="{Binding TransactionInfo.SellConfirmDate}"/>

                <DataGridTextColumn IsReadOnly="True">
                    <DataGridTextColumn.Header>
                        <TextBlock Text="{x:Static coreConsts:CommonName.SpecialInfo}" FontWeight="Bold"/>
                    </DataGridTextColumn.Header>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.VolatilityInThePastYear1}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.Volatility"/>
                            <Binding Source="{StaticResource Number1}"/>
                            <Binding Source="{StaticResource StringFormatP2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.SharpeRatioInThePastYear1}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.SharpeRatio"/>
                            <Binding Source="{StaticResource Number1}"/>
                            <Binding Source="{StaticResource StringFormatF2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.InfoRatioInThePastYear1}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.InfoRatio"/>
                            <Binding Source="{StaticResource Number1}"/>
                            <Binding Source="{StaticResource StringFormatF2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.VolatilityInThePastYear2}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.Volatility"/>
                            <Binding Source="{StaticResource Number2}"/>
                            <Binding Source="{StaticResource StringFormatP2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.SharpeRatioInThePastYear2}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.SharpeRatio"/>
                            <Binding Source="{StaticResource Number2}"/>
                            <Binding Source="{StaticResource StringFormatF2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.InfoRatioInThePastYear2}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.InfoRatio"/>
                            <Binding Source="{StaticResource Number2}"/>
                            <Binding Source="{StaticResource StringFormatF2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.VolatilityInThePastYear3}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.Volatility"/>
                            <Binding Source="{StaticResource Number3}"/>
                            <Binding Source="{StaticResource StringFormatP2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.SharpeRatioInThePastYear3}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.SharpeRatio"/>
                            <Binding Source="{StaticResource Number3}"/>
                            <Binding Source="{StaticResource StringFormatF2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.InfoRatioInThePastYear3}" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource SpecialDictDisplayConverter}">
                            <Binding Path="SpecialInfo.InfoRatio"/>
                            <Binding Source="{StaticResource Number3}"/>
                            <Binding Source="{StaticResource StringFormatF2}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.AnnualizedTrackingError}" IsReadOnly="True" Binding="{Binding SpecialInfo.AnnualizedTrackingError,StringFormat=P2,TargetNullValue=--}"/>
                <DataGridTextColumn Header="{x:Static coreConsts:SpecialColumnName.AverageTrackingErrorOfTheSameType}" IsReadOnly="True" Binding="{Binding SpecialInfo.AverageTrackingErrorOfTheSameType,StringFormat=P2,TargetNullValue=--}"/>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>
